# Учебная виртуальная машина (УВМ)

## 1. Общее описание и назначение
Проект реализует ассемблер, интерпретатор и кроссплатформенное приложение для учебной виртуальной машины (УВМ) в соответствии со спецификацией задания (вариант №8).

Решение включает в себя:
*   **assembler.py** — трансляция текста программы (CSV) в бинарный код.
*   **interpreter.py** — исполнение бинарного кода (Стек/Память) и создание XML-дампа.
*   **build.py** — скрипт автоматической сборки проекта.
*   **uvm_gui.py** — графический интерфейс пользователя.

---

## 2. Спецификация УВМ

### Формат команды
* Размер команды: **4 байта**
* Формат: `A | B`, где
  * `A` — код операции (биты 0–7)
  * `B` — операнд (биты 8–26 или 8–21 в зависимости от команды)
* Порядок байт: **little-endian**

### Поддерживаемые команды

| Команда    | Код A | Операнд B       | Описание                                         |
| ---------- | ----- | --------------- | ------------------------------------------------ |
| LOAD_CONST | 60    | 19 бит          | Поместить константу в стек                       |
| READ_MEM   | 12    | 14 бит          | Прочитать значение из памяти и положить в стек   |
| WRITE_MEM  | 28    | не используется | Записать значение в память (адрес берется со стека) |
| MUL        | 94    | 14 бит          | Умножение значения из памяти и значения со стека |

Команда `WRITE_MEM` **не использует поле B** согласно спецификации. В языке ассемблера операнд допускается формально, но **игнорируется**.

---

## 3. Описание функций и настроек

### Язык ассемблера
Ассемблер использует CSV-формат (`Command,Operand`):
```csv
LOAD_CONST,10
READ_MEM,5
WRITE_MEM,0
MUL,3
```
* Пустые строки и комментарии (`;`) игнорируются.

### Ассемблер (CLI)
**Запуск:**
```bash
python assembler.py input.csv output.bin [--test]
```
**Настройки:**
*   `input.csv` — путь к исходному файлу.
*   `output.bin` — путь к выходному бинарному файлу.
*   `--test` — режим отладки. Выводит бинарное представление команд в консоль строго в формате спецификации (`0x3C, ...`).

### Интерпретатор (CLI)
**Запуск:**
```bash
python interpreter.py program.bin result.xml 0:16
```
**Настройки:**
*   `program.bin` — путь к бинарному файлу.
*   `result.xml` — путь для сохранения XML-дампа памяти.
*   `0:16` — диапазон адресов памяти для записи в дамп (Format: `start:end`).

---

## 4. Сборка и запуск приложений

### Скрипт сборки
Создает дистрибутивы для Desktop и Web:
```bash
python build.py
```
Результаты сохраняются в папку `dist/`.

### GUI-приложение
**Платформы:**
*   **Windows / Linux** (Desktop):
    ```bash
    python uvm_gui.py
    ```
*   **Web-версия** (WASM):
    Реализована полноценная поддержка браузера через **PyScript**.

**Инструкция по запуску Web-версии:**
Из-за политик безопасности браузеров (CORS) локальные файлы нельзя открывать двойным кликом.
1.  Перейдите в папку сборки: `cd dist/web`
2.  Запустите локальный сервер:
    ```bash
    python -m http.server
    ```
3.  Откройте в браузере: `http://localhost:8000`

---

## 5. Примеры использования

### Тестовая задача (Этап 5)
**Файл:** `vector_mul_5x6.csv`
**Описание:** Вектор длины 5 умножается на число 6. Результат перезаписывается в исходные ячейки.

### Дополнительные примеры (Требование №2)

**1. Копирование памяти**
**Файл:** `array_copy.csv`
**Описание:** Демонстрация работы с памятью без АЛУ. Значения из ячеек `100-104` копируются в `200-204`.

**2. Вычисление факториала (5!)**
**Файл:** `math_factorial.csv`
**Описание:** Накопительное произведение. Вычисляется `1 * 2 * 3 * 4 * 5`. Результат (120) сохраняется в `Mem[0]`.

**3. Степени двойки**
**Файл:** `math_powers.csv`
**Описание:** Генерация геометрической прогрессии. Каждое следующее число получается умножением предыдущего на 2. Результат: `2, 4, 8, 16, 32`.